import maya.cmds as cmds
import maya.api.OpenMaya as om

# Replace 'yourMesh' with the name of your mesh
mesh_name = 'yourMesh'

# Get the MSelectionList for the mesh
selection_list = om.MSelectionList()
selection_list.add(mesh_name)

# Get the MDagPath for the mesh
dag_path = selection_list.getDagPath(0)

# Create an MFnMesh on the dagPath
mfn_mesh = om.MFnMesh(dag_path)

# Get all vertices of the mesh
all_vertices = om.MItMeshVertex(dag_path)

# Prepare a list for vertices that are not on the border
non_border_vertices = []

# Iterate through all vertices
while not all_vertices.isDone():
    # Check if the current vertex is on the border
    if not all_vertices.onBoundary():
        # If it's not on the border, add it to the list
        index = all_vertices.index()
        non_border_vertices.append(f'{mesh_name}.vtx[{index}]')
    
    # Move to the next vertex
    all_vertices.next()

# Merge internal vertices only using cmds.polyMergeVertex
if non_border_vertices:
    cmds.select(non_border_vertices)
    cmds.polyMergeVertex(d=0.1)  # Set the distance threshold appropriately

# Clear the selection
cmds.select(clear=True)
